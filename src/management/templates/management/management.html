{% extends 'layout.html' %}
{% load static %}

{% block content %}
<div class="container">
    <div class="" style="margin-top:30px">
        {% if messages or form.non_field_errors %}
        <div class="alert
          {% if messages %}
            {% for message in messages %}
              {% if 'success' in message.tags %}
                alert-success
                {% else %}
                alert-warning
              {% endif %}
            {% endfor %}
          {% else %}
            alert-warning
          {% endif %}
          alert-dismissible fade show" role="alert"
             style="margin-top: 50px;">
            {% if messages %}
            {% for message in messages %}
            {{ message }}
            {% endfor %}
            {% else %}
            {{ form.non_field_errors }}
            {% endif %}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endif %}
    </div>
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <h4 class="mt-3 mb-3">Менеджерские примочки</h4>
            <div class="mb-3">
                <label for="daysSelect" class="form-label">Выберите период</label>
                <select class="form-select" id="daysSelect" name="days_count">
                    <option value="1">1 день</option>
                    <option value="7">1 неделя</option>
                    <option value="30">1 месяц</option>
                    <option value="90">3 месяца</option>
                    <option value="180">6 месяцев</option>
                    <option value="365">1 год</option>
                </select>
            </div>
            <a href="{% url 'management:get_excel_report' 1 %}" class="btn btn-primary w-100" id="downloadBtn">Скачать
                отчет</a>
        </div>
    </div>
</div>
<script>
    document.getElementById('daysSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        var downloadLink = document.getElementById('downloadBtn');
        let parts = downloadLink.href.split('/');
        parts[parts.length - 1] = selectedValue;
        let newUrl = parts.join('/');
        downloadLink.href = newUrl;
    });

</script>
{% endblock content %}
